<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title></title>
  <script>
    /* 定义全局函数有时会污染全局作用域的命名空间，因此使用原型 */

    /* js分为函数对象和普通对象，
    每个对象都有__proto__属性，但是只有函数对象才有prototype属性，函数有两个原型 */

    /* 原型好比对象的公共区域，可以定义一些公共属性，无定义为undefined
    js是基于原型对象的，原型也是一个对象，通过原型可以实现对象的属性继承 */
    const Person = function Person(name, age, gender) {
      this.name = name;
      this.age = age;
      this.gender = gender;
    };
    // 普通对象
    const per1 = new Person('zx', '18', '男');
    const per2 = new Person('zx', '18', '男');

    /* 原型的属性或方法定义 */
    /* 隐式原型，实例化时自动添加，默认值为构造函数的protype属性值 */
    per1.pname = 'z';
    per1.__proto__.pname = "p";
    per1.__proto__.__proto__.pname = "pp";
    Person.prototype.pname = "zxx";
    /* 显示原型，在定义函数时自动添加，默认为空object */
    Person.prototype.tname = "xz";
    /* 函数对象和他的所有子实例共用原型 */
    console.log(1, per1.pname, per1.__proto__.pname, per1.__proto__.__proto__.pname, per2.pname, Person.prototype.pname);
    /* z, zxx, pp, zxx, zxx */
    // 可以看到，_proto_原型有继承属性指向prototype，因此修改prototype会深度影响，但_proto_._proto_指向另一个对象
    // 简而言之，原型链之间没有深度影响指向对象变了，但原型之间有继承。
    console.log(2, per1.__proto__);/* per1的原型为object，指向prototype */
    console.log(3, per1.__proto__.__proto__);/* per1的原型的原型全局Object */
    console.log(4, per1.__proto__.__proto__.__proto__);/* Object的原型没有原型，为null */

    /* 覆写toString，原toString只会返回类型名 */
    per1.toString = function () {
      return this.name;
    };
    /* toString不加()直接返回toString的函数
    只修改per这一个对象的方法，只对该实例生效 */
    console.log(5, per1.toString(), per2.toString());/* zx, [object Object] */

    /* 覆写toStirng返回实例属性 */
    Person.prototype.toString = function () {
      return [this.age, this.pname, this.tname];
    };
    /* 先会在自身查找因此还是zx，因此要注意对象方法与原型的命名问题，
    如果重名还想要调用原型方法，可以先调用原型
    原型age属性没定义，因此undefined，但tname和pname存在
    换句话说原型是一个空的对象只提供定义过的属性并作为公用 */
    console.log(6, per1.toString(), per1.__proto__.toString(), per2.toString());/* zx, undefined, zx ,xz */
  </script>
</head>

<body>
</body>

</html>