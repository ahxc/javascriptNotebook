<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0"
    >
    <title>代码题算法题</title>
</head>

<style>
</style>

<body>
    <div class="box1">
        <div class="box2"></div>
    </div>

    <div id="myDiv"></div>

    <script>
        // 判断一个字符串是否为对称数，例：'123321'
        function symmetry(str = '') {
            return str === str.split('').reverse().join('');
        }
        // print();

        // 使用 setTimeout 实现 setInterval，
        // 注意：setTimeout执行完毕不使用变量保存会自动清空不需手动清空。setInterval也没有立即执行属性不会立即执行。
        function setInterval(fn, time) {
            function loop(params) {
                fn()
                setTimeout(loop, time);
            }
            loop()
        }
        // setInterval(() => {
        //     let i = 0;
        //     i += 1;
        //     console.log(i);
        // }, 1000);

        // 查找第K个最大元素，注意去重版和非去重，通常不用去重。去掉new set即可
        function findKLargest(array, k) {
            const list = Array.from(new Set(array)).sort((a, b) => a - b);
            return list[k - 1];
        }

        // 抚平嵌套数组
        function flat(arr, n = 0) {
            let list = []
            arr.forEach((el) => {
                if (Array.isArray(el) && n > 0) {
                    list = list.concat(flat(el, n - 1))
                }
                else {
                    list.push(el)
                }
            })
            return list
        }
        console.log(flat([1, 2, 3, [4, 5, 6], [7, 8, [9, 10, 11], 12], [13, 14, 15]], 2))

        // 数组排序，先排数字，再排字母，["B3", "D2", "F1", "A9", "D12", "A2", "C1", "Z0", "B1"]
        function sortData(data) {
            return data.sort((a, b) => {
                const [codeA, typeA, numA] = a.match(/([A-Z])(\d+)/);
                const [codeB, typeB, numB] = b.match(/([A-Z])(\d+)/);

                const numComparison = parseInt(numA) - parseInt(numB);
                if (numComparison !== 0) {
                    return numComparison;
                } else {
                    // 比较字母顺序，升序-1，降序1，相同字母aa0。
                    return typeA.localeCompare(typeB);
                }
            });
        }

        const data = ["B3", "D2", "F1", "A9", "D12", "A2", "C1", "Z0", "B1"];


        // 使用promise每隔一秒输出123
        async function print(time) {
            // 基础原理
            // for (let i = 1; i < 4; i++) {
            //     setTimeout(() => {
            //         console.log(i);
            //     }, i * 1000);
            // }

            // promise 改造
            for (let i = 1; i < 4; i++) {
                pro(i);
            }

            function pro(interval) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        console.log(interval);
                        resolve(interval); // 无此句失效，只会打印1，因为await 等不到返回结果，for循环会立即执行，
                    }, 1000);
                });
            }
        }

        /* 盒子内部点击打印false，外部点击打印true，如果是vue的话使用.self修饰符，只有点击事件本身才会触发 */
        var myDiv = document.getElementById('myDiv');
        myDiv.addEventListener('click', function (event) {
            var isInside = event.target === myDiv; // 检查点击的是否是div元素本身  
            console.log(isInside ? '内部点击' : '外部点击');
        });

        // 深拷贝
        function deepClone(data) {
            return JSON.parse(JSON.stringify(data));
        }

        const i = [
            { id: '1', value: '1' },
            { id: '2', value: '2' },
            { id: '3', value: '3' },
            { id: '1-1', value: '1-1', pid: '1' },
            { id: '2-1', value: '2-1', pid: '2' },
            { id: '3-1', value: '3-1', pid: '3' },
            { id: '3-1-1', value: '3-1-1', pid: '3-1' },
        ];

        // 把含树结构的array数据转换为children层级形式的array返回
        function list2tree(list = [], id = 'id', pid = 'pid') {
            // 深拷贝
            const d_list = deepClone(list);

            // key，value字典
            const dic = {};
            for (const i of d_list) {
                dic[i[id]] = i;
            }

            // 树
            const tree = [];
            let index = 0;
            for (const i of d_list) {
                const p = dic[i[pid]];
                if (p) {
                    p.children = p.children ? [...p.children, i] : [i];
                    i.level = (p.level || 0) + 1;
                }
                else {
                    i.level = 0;
                    tree.push(i);
                }
            }
            return deepClone(tree);
        }

        // 组件
        const com = {}
        // 根据上述list2tree生成的数据返回树组件
        function loopComponent(list) {
            for (const i of list) {
                if (Array.isArray(i.children)) {
                    loopComponent(i.children)
                }
                return com
            }
        }

        // 给数字字符串添加千分位，注意小数点。
        // 原生实现 number.toLocaleString() // '123,456.789'
        function addThousandSeparator(num) {
            var numParts = num.toString().split(".");
            numParts[0] = numParts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            return numParts.join(".");
        }

        // json扁平化
        let json = {
            name: 'John',
            age: 30,
            address: {
                city: 'New York',
                state: 'NY',
                zip: '10001',
                addressPlus: {
                    city: 'new london'
                }
            },
            hobbies: ['reading', 'traveling', 'music', ['test', 'test2', ['test3']]]
        };
        function flattenJSON2(obj = {}, prefix = '') {
            let result = {}
            for (const key of Object.keys(obj)) {
                const newPrefix = prefix ? prefix + '_' + key : key
                if (typeof obj[key] === 'object' && obj !== null) {
                    result = Object.assign(result, flattenJSON2(obj[key], newPrefix))
                }
                else {
                    result[newPrefix] = obj[key]
                }
            }
            return result
        }
        // console.log(flattenJSON(json))
    </script>
</body>

</html>